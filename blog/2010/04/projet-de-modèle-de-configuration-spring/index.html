<!DOCTYPE html>
<html lang="en-us">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.53" />

    
    
    

<title>Projet de modèle de configuration Spring • Gildas Cuisinier</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Projet de modèle de configuration Spring"/>
<meta name="twitter:description" content="Présentation d&#39;un projet qui permet d&#39;avoir des modèles de configuration XML pour Spring Framework"/>

<meta property="og:title" content="Projet de modèle de configuration Spring" />
<meta property="og:description" content="Présentation d&#39;un projet qui permet d&#39;avoir des modèles de configuration XML pour Spring Framework" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://example.org/blog/2010/04/projet-de-mod%C3%A8le-de-configuration-spring/" /><meta property="article:published_time" content="2010-04-08T08:00:00&#43;01:00"/>
<meta property="article:modified_time" content="2010-04-08T08:00:00&#43;01:00"/>


    


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">








<link rel="stylesheet" href="/scss/hyde-hyde.7072060d53bb48055d87c305b463893090a2798b2a73a12efc03502e8e2a245d.css" integrity="sha256-cHIGDVO7SAVdh8MFtGOJMJCieYsqc6Eu/ANQLo4qJF0=">


<link rel="stylesheet" href="/scss/print.5aa4005c7565ec5b66c62cd79012c5cad1081f3332793145a8d3861a26391697.css" integrity="sha256-WqQAXHVl7FtmxizXkBLFytEIHzMyeTFFqNOGGiY5Fpc=" media="print">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    

</head>


    <body class=" ">
    
<div class="sidebar">
  <div class="container  vertical-center">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="http://example.org/">Gildas Cuisinier</a>
      </span>
      <small class="text-center center-block">&lt;dev&gt;SomeWhere&lt;ops&gt;</small>
      
      
        
        
        
        <div class="author-image">
          <img src="http://example.org//img/gcuisinier.jpg" alt="Author Image" class="img--circle img--headshot element--center">
        </div>
        
      
      
      <p class="site__description">
        
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">Gildas Cuisinier</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/about/">
						<span>About</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/posts/">
						<span>Blog</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/portfolio/">
						<span>Projects</span>
					</a>
				</li>
			 
		
		</li>
	</ul>
</div>

        <section class="social">
	
	<a href="https://twitter.com/gcuisinier" rel="me"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a>
	
	
	
	<a href="https://github.com/gcuisinier" rel="me"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	
	
	<a href="https://keybase.io/gcuisinier" rel="me"><i class="fab fa-keybase fa-lg" aria-hidden="true"></i></a>
	
	
	
	&nbsp;<a href="https://about.me/gcuisinier"><i class="fas fa-address-card fa-lg" aria-hidden="true"></i></a>
	
	
	&nbsp;<a href="https://hub.docker.com/u/gcuisinier"><i class="fab fa-docker fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	<a href="mailto:contact%20[at]%20gcuisinier.net" rel="me"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a>
	
</section>

      </div>
    </div>
    

<div class="builtwith">
Built with <a href="https://gohugo.io">Hugo</a> ❤️ <a href="https://github.com/htr3n/hyde-hyde">hyde-hyde</a>.
</div>


  </div>
</div>

        <div class="content container">
            
    <article>
  <header>
    <h1>Projet de modèle de configuration Spring</h1>
    
    
<div class="post__meta">
    
    
      <i class="fas fa-calendar-alt"></i> Apr 08, 2010
    
    
    
      
      
          in
          
          
              <a class="badge badge-category" href="/categories/opensource">OPENSOURCE</a>
              •
          
              <a class="badge badge-category" href="/categories/spring">SPRING</a>
              
          
      
    
    
    
    <br/>
    <i class="fas fa-clock"></i> 2 min read
</div>


  </header>
  
  
  <div class="post">
    <h2 id="problème">Problème</h2>

<p>Sur certains projets, j&rsquo;ai eu l&rsquo;occasion de voir des fichiers de configuration Spring de ce type :</p>

<pre><code class="language-xml">&lt;import resource=&quot;monitoring-environnement1.xml&quot;/&gt;
&lt;import resource=&quot;monitoring-environnement2.xml&quot;/&gt;
&lt;import resource=&quot;monitoring-environnement3.xml&quot;/&gt;
</code></pre>

<p>Et bien évidemment, chacun des fichiers de configurations importés était tous semblables, avec comme seule différence les noms de beans Spring ou des valeurs de propriétés.
Si demain, un nouvel environnement devait être ajouté, je vous le donne dans le mille : un copier / coller, un s/environnement1/nouvel-environnement/g  !</p>

<p>Même si cela fonctionne bien, ce n&rsquo;est pas la solution la plus propre : Si le système de monitoring devait être modifié, il faudrait éditer X fichiers, avec le risque d&rsquo;oublier un fichier, ou un valeur&hellip;</p>

<h1 id="solution-1-créer-un-namepace-dédié-au-monitoring">#Solution 1 : Créer un namepace dédié au monitoring</h1>

<p>Une première solution possible serait de remplacer ces imports par un namespace dédié au monitoring. Il suffirait dès lors d&rsquo;utiliser une configuration de ce type :</p>

<pre><code class="language-xml">&lt;monitoring:environnement name=&quot;environnement1&quot;/&gt;
&lt;monitoring:environnement name=&quot;environnement2&quot;/&gt;
</code></pre>

<p>C&rsquo;est déjà beaucoup plus propre, mais cette solution n&rsquo;est pas des plus pratiques :</p>

<ul>
<li>La configuration &ldquo;générique&rdquo; sera réalisée via une API spécifique à Spring, que peu de développeurs connaissent ( BeanDefinitionParser, ParserContext, BeanDefinitionRegistry, ..), ce qui rends toute modification assez complexe</li>
<li>Le namespace sera dédié au monitoring ! Si le domaine des fichiers était tout autre, il faudrait développer un nouveau namespace.</li>
<li>Le namespace va cacher aux utilisateurs les beans réellement instanciés</li>
</ul>

<p>Bref, c&rsquo;est déjà mieux mais pas encore suffisamment claire et simple.</p>

<h1 id="solution-2-créer-un-namepace-d-importation-de-modèles-de-configuration">#Solution 2 : Créer un namepace d&rsquo;importation de modèles de configuration</h1>

<p>Afin de répondre à ces problématique, il est possible de créer un namespace beaucoup plus générique. Celui qui permettrait d&rsquo;importer une configuration classique (un modèle), mais en remplaçant certaines variables par des valeurs.</p>

<p>Le modèle serait un fichier de configuration Spring tout à fait compréhensible par des habitués de Spring, mais dans laquelle des variables seraient définies :</p>

<pre><code class="language-xml">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
       xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;&gt; 

    &lt;bean name=&quot;scheduledTimeTask.${environnement}&quot; class=&quot;org.springframework.scheduling.timer.ScheduledTimerTask&quot;&gt;
        &lt;property name=&quot;timerTask&quot; ref=&quot;monitoringTask.${environnement}&quot;/&gt; 

        &lt;property name=&quot;delay&quot; value=&quot;1000&quot;/&gt;
        &lt;property name=&quot;period&quot; value=&quot;1000&quot;/&gt;
    &lt;/bean&gt;
    &lt;bean name=&quot;timer.${environnement}&quot; class=&quot;org.springframework.scheduling.timer.TimerFactoryBean&quot;&gt;
        &lt;property name=&quot;scheduledTimerTasks&quot;&gt;
            &lt;list&gt;
                &lt;ref bean=&quot;scheduledTimeTask.${environnement}&quot;/&gt;
            &lt;/list&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
    &lt;bean name=&quot;monitoringTask.${environnement}&quot; class=&quot;be.hikage.springtemplate.MonitoringTimerTask&quot;&gt;
           &lt;property name=&quot;url&quot; value=&quot;${${environnement}.url}&quot;/&gt;
    &lt;/bean&gt; 

&lt;/beans&gt;
</code></pre>

<p>Ici, <span style="font-family: Consolas, Monaco, 'Courier New', Courier, monospace; line-height: 18px; font-size: 12px; white-space: pre;">${environnement}</span>, est une variable qui sera définie lors de l&rsquo;importation du modèle :</p>

<pre><code class="language-xml">        &lt;hikage:import-template location=&quot;template-monitoring.xml&quot;&gt;
        &lt;hikage:variable name=&quot;environnement&quot; value=&quot;environnement1&quot;/&gt;
    &lt;/hikage:import-template&gt;
</code></pre>

<h2 id="conclusion">Conclusion</h2>

<p>Cette solution possède donc plusieurs avantages :
<ul>
    <li>En cas de modification du modèle, un seul fichier devra être modifié.</li>
    <li>Le namespace pourra être utilisé pour différent domaine ( monotoring, etc .. )</li>
    <li>Le modèle sera modifiable par n&rsquo;importe quel développeur connaissant Spring, et tout à fait lisible</li>
</ul></p>

<h2 id="informations">Informations</h2>

<p>Ce projet est disponible sous licence Apache 2 sur <a href="http://code.google.com/p/spring-import-template">http://code.google.com/p/spring-import-template/</a></p>
  </div>
  

<div class="navigation navigation-single">
    
    
    <a href="/blog/2010/04/cr%C3%A9er-un-namespace-spring/" class="navigation-next">
      <span class="navigation-tittle">Créer un namespace Spring</span>
      <i aria-hidden="true" class="fa fa-chevron-right"></i>
    </a>
    
</div>


  

  
    


</article>


        </div>
        
    
<script defer src="https://use.fontawesome.com/releases/v5.5.0/js/all.js" integrity="sha384-GqVMZRt5Gn7tB9D9q7ONtcp4gtHIUEW/yG7h98J7IpE3kpi+srfFyyB/04OV6pG0" crossorigin="anonymous"></script>


    
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
        
    
    <script type="text/javascript">
        
        hljs.initHighlightingOnLoad();
    </script>
    




    



    </body>
</html>
